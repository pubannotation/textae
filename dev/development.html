<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="outer.css" />
    <link rel="stylesheet" href="/src/lib/css/textae.css">
    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="bundle.js"></script>
</head>

<body>
    <div id="css_area"></div>

    <input title="this is a focusable element before textae" placeholder="I don't use it for anything.">
    <span>Welcome!</span>
    <div class="textae-editor" title="editor0" mode="term-edit" inspect="abc" status_bar="on"
        source="https://pubannotation.org/projects/DisGeNET/docs/sourcedb/PubMed/sourceid/10021369/annotations.json"
        config_lock="true"></div>
    <div id="abc"></div>
    <div class="textae-editor" title="editor1" mode="block-edit" status_bar="on" config="1_config.json?aaa"
        source="1_annotations.json?bbbb=aaa" autocompletion_ws="/dev/autocomplete?order=desc" config_lock="false"></div>
    <input title="this is a focusable element after textae" placeholder="I don't use it for anything.">
    <div class="textae-editor" title="editor2 for confirm a priority source and target parameters"
        config="2_config.json" style="line-height: 14px;" target="dummy" source="2_annotations.json?config_lock=true"
        config_lock="false" mode="edit" control="visible"></div>
    <div class="textae-editor" title="editor3 having annotations for the simple mode"
        source="2_annotations.json?config_lock=false" config="2_config.json" mode="edit" control="hidden"></div>
    <div class="textae-editor" title="editor4 having annotations for the instance mode with the view mode"
        config="2_config.json" target="3_annotations.json" status_bar="off" control="hidden"></div>
    <div class="textae-editor" title="editor5 having inline config" target="1_annotations.json" mode="relation-edit" status_bar='on'>
        {
            "config": {
                "relation types": [
                    {
                        "color": "#5CFF0A",
                        "id": "locatedAt"
                    },
                    {
                        "color": "#FF0000",
                        "id": "themeOf"
                    },
                    {
                        "color": "#0000FF",
                        "id": "equivalentTo"
                    }
                ],
                "entity types": [
                    {
                        "color": "#FFFF00",
                        "id": "Protein",
                        "default": true
                    },
                    {
                        "color": "#FF0000",
                        "id": "Cell"
                    },
                    {
                        "color": "#00FF00",
                        "id": "Transcription"
                    },
                    {
                        "color": "#FFFF00",
                        "id": "Gene_expression"
                    },
                    {
                        "color": "#FF00FF",
                        "id": "Negative_regulation"
                    },
                    {
                        "color": "#00FFFF",
                        "id": "Positive_regulation"
                    },
                    {
                        "color": "#FFFF66",
                        "id": "Regulation",
                        "uri": "http://www.yahoo.co.jp"
                    },
                    {
                        "color": "#666666",
                        "id": "New"
                    },
                    {
                        "color": "#0000FF",
                        "id": "Sentence"
                    }
                ]
            },
            "text":"Ribonucleic acid (RNA) is a ubiquitous family of large biological molecules that perform multiple vital roles in the coding, decoding, regulation, and expression of genes.",
            "denotations":[
                {
                    "id":"E3",
                    "span":{
                        "begin":165,
                        "end":170
                    },
                    "obj":"http://dbpedia.org/ontology/parent"
                },
                {
                    "id":"E4",
                    "span":{
                        "begin":89,
                        "end":97
                    },
                    "obj":"something"
                }
            ],
            "relations":[
                {
                    "id":"R1",
                    "pred":"something",
                    "subj":"E4",
                    "obj":"E3"
                }
            ]
        }
    </div>
    <div class="textae-editor" title="editor6 for save_to parameter" target="3_annotations.json"
        save_to="http://pubannotation.org/projects/penguin-fly/docs/sourcedb/PubMed/sourceid/10089213/annotations.json"      mode="edit"></div>
    <div class="textae-editor" title="editor7 import a target file from a text file." mode="edit" status_bar="on"></div>
    <div class="textae-editor" title="editor8" mode="edit">
        {
            "text":"   I have a stomach  ache.",
            "denotations":[
                {"span":{"begin":12,"end":19},
                "obj":"http://purl.obolibrary.org/obo/UBERON_0000945"}
            ]
        }
    </div>

    <script>
        window.addEventListener('load', () => document.querySelector('.textae-editor').focus())
        exampleOfInitializeTextAEEditor()

        // After the other TextAE initialization processes are complete,
        // add div and initialize the TextAE editor from the JavaScript program.
        function exampleOfInitializeTextAEEditor() {
            // Specify the body as the element to observe
            var targetNode = document.body;

            // Create an observer instance
            var observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    // For each mutation, check the nodes that were added
                    for (const node of mutation.addedNodes) {
                        // Check if the added node is a div element, has the specified class, and matches the specified style
                        if (node.nodeType === 1 && node.classList.contains('textae-editor-veil')) {
                            initializeTextAE();
                        }
                    }
                });
            });

            // Observer configuration: also observe changes in the child nodes
            var config = { childList: true, subtree: true };

            // Pass the target node and the observer configuration
            observer.observe(targetNode, config);
        }

        function initializeTextAE() {
            // initializeTextAEEditor initializes an HTML element with the textae-editor class as a TextAE editor.
            // Add a div element with textae-editor class.
            var html = '<div id="my_text-ae_editor" class="textae-editor" title="dynamic-editor0" mode="edit"></div>';
            document.body.insertAdjacentHTML('afterbegin', html);

            // The initializeTextAEEditor function may initialize multiple TextAE editors.
            // It returns an array of initialized editors.
            // It has the ID of the HTML element in the id property.
            const editor = window.initializeTextAEEditor()
                .find((editor) => editor.id === 'my_text-ae_editor')

            // The TextAE editor displays the annotation set in the annotation property.
            editor.annotation = { "text": "This is a TextAE editor dynamically created from a JavaScript program." }

            // When you edit an annotation in the TextAE editor,
            // the changed annotation is notified to the callback function set in the inspectCallback property
            // each time you edit it.
            editor.inspectCallback = (annotation) => { console.log(annotation) }
        }
    </script>
</body>

</html>
